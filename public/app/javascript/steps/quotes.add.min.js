$(()=>{let e,t,o,a,s,r;o=$("body"),r=[],$(document).on("click","[data-hellofresh='quotes:add,submit']",function(){i($(document).find("[data-form]"))}).on("click","card",function(){let e=this.childNodes[1].innerHTML,t=a.find("input[type='text']");t.val(e),setTimeout(()=>{i($(document).find("[data-form]"))},20)}).on("input","input[type='text']",function(){let o=a.find('[data-element="quotes:add,recommended"]'),s=this.name;switch(t=this.value,s){case"author":e=dynamicHost+"/dyn/content/search-authors";break;case"source":e=dynamicHost+"/dyn/content/search-sources";break;case"category":e=dynamicHost+"/dyn/content/search-categories";break;default:return!1}if(n(t))return!1;$.ajax({url:e,data:{search:t},method:"POST",dataType:"HTML",success:e=>{0!==e&&(o.empty(),o.append(e))},error:e=>{console.error(e)}})}).on("click",'[data-action="popup:quotes,add"]',function(){e=dynamicHost+"/dyn/steps/quotes/author",overlay=Overlay.add(o,$(this),!1),$.ajax({url:e,type:"POST",dataType:"JSON",success:function(e){e.status&&(overlay.overlay.append(e.message),a=overlay.overlay.find("popup-module"),s=overlay.overlay.find("steps"),setTimeout(()=>{u([a,s],!0),a.find("card").addClass("slideUpSlow"),$(document).find("input[type='text']").focus()},600))},error:function(e){console.error(e)}})}).on("submit","[data-form='quotes:add,author']",function(){if(e=dynamicHost+"/dyn/steps/quotes/quote",t=new FormData(this),n(t.get("author")))return!1;$.ajax({url:e,data:t,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:e=>{e.status?(r.aid=e.aid,u([a,s],!1),setTimeout(()=>{a.empty().prepend(e.message),setTimeout(()=>{s.find(".description p[here]").html("Write down the actual quote by "+t.get("author")),u([a,s],!0)},100)},1e3)):showErrorModule(e.message)},error:e=>{console.error(e)}})}).on("submit","[data-form='quotes:add,quote']",function(){e=dynamicHost+"/dyn/steps/quotes/source",t=new FormData(this),t.append("aid",r.aid);for(let e of t.entries())if(n(e[1]))return!1;$.ajax({url:e,data:t,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:e=>{e.status?(r.quote=e.quote,r.qid=e.qid,u([a,s],!1),setTimeout(()=>{a.empty().prepend(e.message),setTimeout(()=>{s.find(".description p[here]").html("The source is, where you heard or read about the quote"),u([a,s],!0)},100)},1e3)):showErrorModule(e.message)},error:e=>{console.error(e)}})}).on("submit","[data-form='quotes:add,source']",function(){e=dynamicHost+"/dyn/steps/quotes/categories",t=new FormData(this),t.append("aid",r.aid),t.append("quote",r.quote),t.append("qid",r.qid);for(let e of t.entries())if(n(e[1]))return!1;$.ajax({url:e,data:t,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:e=>{e.status?(r.sid=e.sid,console.log(r),u([a,s],!1),setTimeout(()=>{a.empty().prepend(e.message),setTimeout(()=>{s.find(".description p[here]").html("Choose a category, that describes the quote's content"),u([a,s],!0)},100)},1e3)):showErrorModule(e.message)},error:e=>{console.error(e)}})}).on("submit","[data-form='quotes:add,category']",function(){e=dynamicHost+"/dyn/steps/quotes/all",t=new FormData(this),t.append("aid",r.aid),t.append("quote",r.quote),t.append("qid",r.qid),t.append("sid",r.sid);for(let e of t.entries())if(n(e[1]))return!1;$.ajax({url:e,data:t,method:this.method,dataType:"HTML",contentType:!1,processData:!1,success:e=>{e?(u([a,s],!1),setTimeout(()=>{a.empty().prepend(e),setTimeout(()=>{s.find(".description p[here]").html("That's how your quote will look like"),s.find("hellofresh").attr("data-action","quotes:add,all,submit").html('<i class="ri-check-line std"></i>'),u([a,s],!0)},100)},1e3)):showErrorModule(e.message)},error:e=>{console.error(e)}})}).on("click","[data-action='quotes:add,all,submit']",function(){e=dynamicHost+"/dyn/steps/quotes/_submit";let t=document.querySelector('[data-form="quotes:add,all"]');submitAllResult=d(t,e),submitAllResult?(overlay=Overlay.add(o,$(this),!1,"1001","var(--colour-lila-200)"),setTimeout(()=>{overlay.overlay.append('<popup-module class="active"><div class="confirmation-text centered"><p>Lovely!</p></div></popup-module>'),setTimeout(()=>{closeOverlay(o)},1800)},600)):showErrorModule("A wild error appeared, fight it!")});let d=(e,o)=>{let a=!0;t=new FormData(e);for(let e of t.entries())if(n(e[1]))return!1;return a=$.ajax({url:o,data:t,method:"POST",dataType:"JSON",contentType:!1,processData:!1,success:e=>{if(!e.status)return!1},error:e=>{console.error(e)}}),a};const n=e=>$.trim(e).length<1,i=e=>{e.submit()},u=(e,t=!0)=>{for(let o=0;o<e.length;o++)t?e[o].addClass("active"):e[o].removeClass("active");return!0}});