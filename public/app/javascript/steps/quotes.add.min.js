$(()=>{let e,o,t,s,d,a;t=$("body"),a={quote_id:0},$(document).on("click","[data-hellofresh='quotes:add,submit']",function(){r($(document).find("[data-form]"))}).on("click","card",function(){let e=this.childNodes[1].innerHTML,o=s.find("input[type='text']");o.val(e),setTimeout(()=>{r($(document).find("[data-form]"))},20)}).on("input","input[type='text']",function(){let t=s.find('[data-element="quotes:add,recommended"]'),d=this.name;switch(o=this.value,d){case"author":e=dynamicHost+"/do/content/search-authors";break;case"source":e=dynamicHost+"/do/content/search-sources";break;case"category":e=dynamicHost+"/do/content/search-categories";break;default:return!1}if(i(o))return!1;$.ajax({url:e,data:{search:o},method:"POST",dataType:"HTML",success:e=>{0!==e&&(t.empty(),t.append(e))},error:e=>{console.error(e)}})}).on("click",'[data-action="popup:quotes,add"]',function(){console.log("Adding quote initialized: quote_id is",a.quote_id),e=dynamicHost+"/template/quotes/add/author",overlay=Overlay.add(t,$(this),!1),console.log("Loading start template..."),$.ajax({url:e,type:"POST",dataType:"HTML",success:function(e){e&&(overlay.overlay.append(e),console.log("Done!"),s=overlay.overlay.find("popup-module"),d=overlay.overlay.find("steps"),setTimeout(()=>{u([s,d],!0),s.find("card").addClass("slideUpSlow"),$(document).find("input[type='text']").focus()},600))},error:function(e){console.error(e)}})}).on("submit","[data-form='quotes:add,author']",function(){if(console.log("Step",1,"initilized: quote_id is",a.quote_id),e=dynamicHost+"/do/quotes/add/author",o=new FormData(this),i(o.get("author")))return!1;$.ajax({url:e,data:o,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:o=>{console.log("Step",1,"ajax done: quote_id is",o.quote_id),o.status?(a={},console.log("Step",1,"draftObject:",a),u([s,d],!1),setTimeout(()=>{a.quote_id=o.quote_id,console.log("Step",1,"quote_id updated: is",a.quote_id),e=dynamicHost+"/template/quotes/add/quote",n(e,s,a),setTimeout(()=>{d.find(".description p[here]").html("Write down the quote"),u([s,d],!0)},100)},1e3)):showErrorModule(o.message)},error:e=>{console.error(e)}})}).on("submit","[data-form='quotes:add,quote']",function(){console.log("Step",2,"initilized: quote_id is",a.quote_id),e=dynamicHost+"/do/quotes/add/quote",o=new FormData(this),o.append("quote_id",a.quote_id);for(let e of o.entries())if(i(e[1]))return!1;$.ajax({url:e,data:o,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:o=>{console.log("Step",2,"ajax done: quote_id is",a.quote_id),o.status?(a={},console.log("Step",2,"draftObject:",a),u([s,d],!1),setTimeout(()=>{a.quote_id=o.quote_id,console.log("Step",2,"quote_id updated: is",a.quote_id),e=dynamicHost+"/template/quotes/add/source",n(e,s,a),setTimeout(()=>{d.find(".description p[here]").html("The source is, where you heard or read about the quote"),u([s,d],!0)},100)},1e3)):showErrorModule(o.message)},error:e=>{console.error(e)}})}).on("submit","[data-form='quotes:add,source']",function(){console.log("Step",3,"initilized: quote_id is",a.quote_id),e=dynamicHost+"/do/quotes/add/source",o=new FormData(this),o.append("quote_id",a.quote_id);for(let e of o.entries())if(i(e[1]))return!1;$.ajax({url:e,data:o,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:o=>{console.log("Step",3,"ajax done: quote_id is",a.quote_id),o.status?(a={},console.log("Step",3,"draftObject:",a),u([s,d],!1),setTimeout(()=>{a.quote_id=o.quote_id,console.log("Step",3,"quote_id updated: is",a.quote_id),e=dynamicHost+"/template/quotes/add/categories",n(e,s,a),setTimeout(()=>{d.find(".description p[here]").html("Choose a category, that describes the quote's content"),u([s,d],!0)},100)},1e3)):showErrorModule(o.message)},error:e=>{console.error(e)}})}).on("submit","[data-form='quotes:add,category']",function(){console.log("Step",4,"initilized: quote_id is",a.quote_id),e=dynamicHost+"/do/quotes/add/categories",o=new FormData(this),o.append("quote_id",a.quote_id);for(let e of o.entries())if(i(e[1]))return!1;$.ajax({url:e,data:o,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:o=>{console.log("data:",o),console.log("Step",4,"ajax done: quote_id is",a.quote_id),o.status?(a={},console.log("Step",4,"draftObject:",a),u([s,d],!1),setTimeout(()=>{a.quote_id=o.quote_id,console.log("Step",4,"quote_id updated: is",a.quote_id),e=dynamicHost+"/template/quotes/add/review",n(e,s,a),setTimeout(()=>{d.find(".description p[here]").html("That's how your quote will look like!"),d.find("hellofresh").attr("data-action","quotes:add,all,submit").html('<i class="ri-check-line std"></i>'),u([s,d],!0)},100)},1e3)):showErrorModule(o.message)},error:e=>{console.error(e)}})}).on("click","[data-action='quotes:add,all,submit']",function(){console.log("Step",5,"initilized: quote_id is",a.quote_id),e=dynamicHost+"/do/quotes/add/publish",console.log("Submission started..."),$.ajax({url:e,data:{quote_id:a.quote_id},method:"POST",dataType:"JSON",success:e=>{console.log("Step",5,"submission successful..."),console.log("Data:",e),e.status?(console.log("Step",5,"quote",a.quote_id,"published successfully!"),overlay=Overlay.add(t,$(this),!1,"1001","var(--colour-lila-200)"),setTimeout(()=>{overlay.overlay.append('<popup-module class="active"><div class="confirmation-text centered"><p>Lovely!</p></div></popup-module>'),setTimeout(()=>{closeOverlay(t)},1800)},600)):(console.error("Step",5,"quote",a.quote_id,"publishing failed!"),showErrorModule("A wild error appeared, fight it!"))},error:e=>{console.error(e)}})});const i=e=>$.trim(e).length<1,r=e=>{e.submit()},u=(e,o=!0)=>{for(let t=0;t<e.length;t++)o?e[t].addClass("active"):e[t].removeClass("active");return!0};let n=(e,o,t={})=>{console.log("Getting template...");let s=e,d=o,a=t;return $.ajax({url:s,data:a,method:"POST",dataType:"HTML",success:e=>(d.empty().prepend(e),console.log("New template loaded!"),!0),error:e=>(console.error(e),!1)}),!1}});