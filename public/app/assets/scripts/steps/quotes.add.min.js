$(()=>{let e,t,o,a,s,r;o=$("body"),r={quote_id:0},$(document).on("click","[data-hellofresh='quotes:add,submit']",function(){i($(document).find("[data-form]"))}).on("click","card",function(){let e=this.childNodes[1].innerHTML,t=a.find("input[type='text']");t.val(e),setTimeout(()=>{i($(document).find("[data-form]"))},20)}).on("input","input[type='text']",function(){let o=a.find('[data-element="quotes:add,recommended"]'),s=this.name;switch(t=this.value,s){case"author":e=dynamicHost+"/do/content/search-authors";break;case"source":e=dynamicHost+"/do/content/search-sources";break;case"category":e=dynamicHost+"/do/content/search-categories";break;default:return!1}if(d(t))return!1;$.ajax({url:e,data:{search:t},method:"POST",dataType:"HTML",success:e=>{0!==e&&(o.empty(),o.append(e))},error:e=>{console.error(e)}})}).on("click",'[data-action="popup:quotes,add"]',function(){e=dynamicHost+"/template/quotes/add/author",overlay=Overlay.add(o,$(this),!1),$.ajax({url:e,type:"POST",dataType:"HTML",success:function(e){e&&(overlay.overlay.append(e),a=overlay.overlay.find("popup-module"),s=overlay.overlay.find("steps"),setTimeout(()=>{u([a,s],!0),a.find("card").addClass("slideUpSlow"),$(document).find("input[type='text']").focus()},600))},error:function(e){console.error(e)}})}).on("submit","[data-form='quotes:add,author']",function(){if(e=dynamicHost+"/do/quotes/add/author",t=new FormData(this),d(t.get("author")))return!1;$.ajax({url:e,data:t,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:t=>{t.status?(r={},u([a,s],!1),setTimeout(()=>{r.quote_id=t.quote_id,e=dynamicHost+"/template/quotes/add/quote",n(e,a,r),setTimeout(()=>{s.find(".description p[here]").html("Write down the quote"),u([a,s],!0)},100)},1e3)):showErrorModule(t.message)},error:e=>{console.error(e)}})}).on("submit","[data-form='quotes:add,quote']",function(){e=dynamicHost+"/do/quotes/add/quote",t=new FormData(this),t.append("quote_id",r.quote_id);for(let e of t.entries())if(d(e[1]))return!1;$.ajax({url:e,data:t,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:t=>{t.status?(r={},u([a,s],!1),setTimeout(()=>{r.quote_id=t.quote_id,e=dynamicHost+"/template/quotes/add/source",n(e,a,r),setTimeout(()=>{s.find(".description p[here]").html("The source is, where you heard or read about the quote"),u([a,s],!0)},100)},1e3)):showErrorModule(t.message)},error:e=>{console.error(e)}})}).on("submit","[data-form='quotes:add,source']",function(){e=dynamicHost+"/do/quotes/add/source",t=new FormData(this),t.append("quote_id",r.quote_id);for(let e of t.entries())if(d(e[1]))return!1;$.ajax({url:e,data:t,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:t=>{t.status?(r={},u([a,s],!1),setTimeout(()=>{r.quote_id=t.quote_id,e=dynamicHost+"/template/quotes/add/categories",n(e,a,r),setTimeout(()=>{s.find(".description p[here]").html("Choose a category, that describes the quote's content"),u([a,s],!0)},100)},1e3)):showErrorModule(t.message)},error:e=>{console.error(e)}})}).on("submit","[data-form='quotes:add,category']",function(){e=dynamicHost+"/do/quotes/add/categories",t=new FormData(this),t.append("quote_id",r.quote_id);for(let e of t.entries())if(d(e[1]))return!1;$.ajax({url:e,data:t,method:this.method,dataType:"JSON",contentType:!1,processData:!1,success:t=>{t.status?(r={},u([a,s],!1),setTimeout(()=>{r.quote_id=t.quote_id,e=dynamicHost+"/template/quotes/add/review",n(e,a,r),setTimeout(()=>{s.find(".description p[here]").html("That's how your quote will look like!"),s.find("hellofresh").attr("data-action","quotes:add,all,submit").html('<i class="ri-check-line std"></i>'),u([a,s],!0)},100)},1e3)):showErrorModule(t.message)},error:e=>{console.error(e)}})}).on("click","[data-action='quotes:add,all,submit']",function(){e=dynamicHost+"/do/quotes/add/publish",$.ajax({url:e,data:{quote_id:r.quote_id},method:"POST",dataType:"JSON",success:e=>{e.status?(overlay=Overlay.add(o,$(this),!1,"1001","var(--colour-lila-200)"),setTimeout(()=>{overlay.overlay.append('<popup-module class="active"><div class="confirmation-text centered"><p>Lovely!</p></div></popup-module>'),setTimeout(()=>{closeOverlay(o)},1800)},600)):(console.error("Step",5,"quote",r.quote_id,"publishing failed!"),showErrorModule("A wild error appeared, fight it!"))},error:e=>{console.error(e)}})});const d=e=>$.trim(e).length<1,i=e=>{e.submit()},u=(e,t=!0)=>{for(let o=0;o<e.length;o++)t?e[o].addClass("active"):e[o].removeClass("active");return!0};let n=(e,t,o={})=>{let a=e,s=t,r=o;return $.ajax({url:a,data:r,method:"POST",dataType:"HTML",success:e=>(s.empty().prepend(e),!0),error:e=>(console.error(e),!1)}),!1}});